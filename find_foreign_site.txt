//对site_word_count_2表统计site查询词中英文词所占的比例
//统计一个site查询词的总数,3594500
create table site_totalNum as select site,sum(count) as totalNum from site_word_count_2 group by site;
//统计一个site中文词的总数
create table site_chineseWord_count as select site,word as chineseWord,count from site_word_count_2 where word rlike '[\\u4e00-\\u9fa5]+';
//计算一个site中文词的总数,site_chineseNum大小为2847071
create table site_chineseNum as select site,sum(count) as chineseNum from site_chineseWord_count group by site;
//统计一个site英文词总数
create table site_englishWord_count as select site,word as englishWord,count from site_word_count_2 where word rlike '^[\\uff41-\\uff5a]+$';
//计算一个site中英文词总数,site_englishNum大小为1608739
create table site_englishNum as select site,sum(count) as englishNum from site_englishWord_count group by site;
//统计一个site中数字查询词的总数
create table site_digitalWord_count as select site,word as digitalWord ,count from site_word_count_2 where word rlike '^[\\uff10-\\uff19]+$';
//计算一个site中包含数字的个数,900611
create table site_digitalNum as select site,sum(count) as digitalNum from site_digitalWord_count group by site; 
//统计一个site对应的色情词总数
create table site_pornWord_count as select a.site,a.word as pornWord,a.count from site_word_count_2 a where a.word in (select b.yellowword from yellowwords b);
//计算一个site包含色情词的总数,518835
create table site_pornNum as select site,sum(count) as pornNum from site_pornWord_count group by site;
//对site_totalNum,site_chineseNum,site_englishNum,site_digitalNum,site_pornNum进程5表join
create table site_totalNum_chineseNum_englishNum_digitalNum_pornNum as select a.site,a.totalNum,b.chineseNum,c.englishNum,d.digitalNum,e.pornNum from site_totalNum a left outer join site_chineseNum b on (a.site = b.site) left outer join site_englishNum c on (a.site = c.site) left outer join site_digitalNum d on (a.site = d.site) left outer join site_pornNum e on (a.site = e.site);
//将site_totalNum_chineseNum_englishNum_digitalNum_pornNum转化成百分比形式
create table site_chinesePercent_englishPercent_digitalPercent_pornPercent as select site, if(chineseNum is NULL,0.0,chineseNum/totalNum) as chinesePercent,if(englishNum is NULL,0.0,englishNum/totalNum) as englishPercent,if(digitalNum is NULL,0.0,digitalNum/totalNum) as digitalPercent,if(pornNum is NULL,0.0,pornNum/totalNum) as pornPercent from site_totalNum_chineseNum_englishNum_digitalNum_pornNum;
//对site_chinesePercent_englishPercent_digitalPercent_pornPercent 和 site_totalNum_chineseNum_englishNum_digitalNum_pornNum 过滤掉非法site
create table site_chinesePercent_englishPercent_digitalPercent_pornPercent_2 as select site,chinesePercent,englishPercent,digitalPercent,pornPercent from site_chinesePercent_englishPercent_digitalPercent_pornPercent where site rlike '^[0-9a-z]+.[a-z]+$';
create table site_totalNum_chineseNum_englishNum_digitalNum_pornNum_2 as select site,totalNum,chineseNum,englishNum,digitalNum,pornNum from site_totalNum_chineseNum_englishNum_digitalNum_pornNum where site rlike '^[0-9a-z]+.[a-z]+$';








